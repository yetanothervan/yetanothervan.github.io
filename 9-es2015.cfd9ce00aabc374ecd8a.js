(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"1QCC":function(e,t,r){"use strict";r.d(t,"d",(function(){return n})),r.d(t,"a",(function(){return i})),r.d(t,"e",(function(){return s})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return l})),r.d(t,"f",(function(){return c})),r("EcEN");var a=r("LvDl");const n=(e,t)=>a.isEqual(e,t),i=e=>a.cloneDeep(e),s=(e,t)=>a.isEqual(e,t),o=e=>a.cloneDeep(e),l=e=>a.cloneDeep(e),c=(e,t)=>a.isEqual(e,t)},"6eBy":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var a=r("l7GE"),n=r("ZUHj");function i(e){return t=>t.lift(new s(e))}class s{constructor(e){this.durationSelector=e}call(e,t){return t.subscribe(new o(e,this.durationSelector))}}class o extends a.a{constructor(e,t){super(e),this.durationSelector=t,this.hasValue=!1,this.durationSubscription=null}_next(e){try{const t=this.durationSelector.call(this,e);t&&this._tryNext(e,t)}catch(t){this.destination.error(t)}}_complete(){this.emitValue(),this.destination.complete()}_tryNext(e,t){let r=this.durationSubscription;this.value=e,this.hasValue=!0,r&&(r.unsubscribe(),this.remove(r)),r=Object(n.a)(this,t),r&&!r.closed&&this.add(this.durationSubscription=r)}notifyNext(e,t,r,a,n){this.emitValue()}notifyComplete(){this.emitValue()}emitValue(){if(this.hasValue){const e=this.value,t=this.durationSubscription;t&&(this.durationSubscription=null,t.unsubscribe(),this.remove(t)),this.value=null,this.hasValue=!1,super._next(e)}}}},Lcz0:function(e,t,r){"use strict";r.r(t);var a={};r.r(a),r.d(a,"mealTypeUpdate",(function(){return p})),r.d(a,"mealTypeCreate",(function(){return b})),r.d(a,"mealTypeDelete",(function(){return m})),r.d(a,"mealTypeDeleteFailed",(function(){return h}));var n=r("ofXK"),i=r("3Pt+"),s=r("tyNb"),o=r("fXoL");let l=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Jb({type:e,selectors:[["rg-meal-types-shell"]],decls:1,vars:0,template:function(e,t){1&e&&o.Qb(0,"router-outlet")},directives:[s.g],encapsulation:2,changeDetection:0}),e})();class c{}var d=r("RLuz"),u=r("kt0X");const p=Object(u.n)("[MealTypes] Update",Object(u.s)()),b=Object(u.n)("[MealTypes] Create",Object(u.s)()),m=Object(u.n)("[MealTypes] Delete",Object(u.s)()),h=Object(u.n)("[MealTypes] DeleteFailed",Object(u.s)());var f=r("FrCf"),y=r("1QCC"),v=r("XNiG"),T=r("l5mm"),C=r("lJxs"),O=r("6eBy");function g(e,t){1&e&&(o.Vb(0,"div"),o.Fc(1,"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u0432\u0435\u0441\u0442\u0438 \u043d\u0430\u0438\u043ce\u043d\u043e\u0432\u0430\u043d\u0438\u0435"),o.Ub())}function j(e,t){1&e&&(o.Vb(0,"div"),o.Fc(1,"\u0421\u0443\u043c\u043c\u0430 \u043f\u0440\u043e\u0446\u0435\u043d\u0442\u043e\u0432 \u0431\u0435\u043b\u043a\u043e\u0432, \u0436\u0438\u0440\u043e\u0432 \u0438 \u0443\u0433\u043b\u0435\u0432\u043e\u0434\u043e\u0432 \u0434\u043e\u043b\u0436\u043d\u0430 \u0442\u043e\u0447\u043d\u043e \u0440\u0430\u0432\u043d\u044f\u0442\u0441\u044f 100"),o.Ub())}let k=(()=>{class e{constructor(e){this.fb=e,this.saved=new o.o,this.form=this.fb.group({caption:["",i.s.required],kkal:0,protein:0,fat:0,carbon:0},{validators:[this.validatorSumIs100]}),this._mealTypeSub=new v.a,this._mealType$=this._mealTypeSub.asObservable().pipe(Object(C.a)(e=>e)),this._mealType$.subscribe(e=>{this.patchForm(e),this.recalculateFormChanges(e)}),this.form.valueChanges.pipe(Object(O.a)(()=>Object(T.a)(500))).subscribe(e=>{this.mealType.caption=e.caption,this.mealType.kkalTotal=e.kkal,this.mealType.proteinPart=e.protein,this.mealType.fatPart=e.fat,this.mealType.carbonPart=e.carbon,this.recalculateFormChanges(this.mealType)})}get mealType(){return this._mealType}set mealType(e){(!this._mealType&&e||e&&this._mealType&&e.id!==this._mealType.id)&&(this._mealType=Object(y.c)(e),this._mealTypeOriginal=Object(y.c)(e),this._mealTypeSub.next(this._mealType),this.form.markAsPristine(),this.form.markAsUntouched())}ngOnInit(){}patchForm(e){this.form.patchValue({caption:e.caption,kkal:e.kkalTotal,protein:e.proteinPart,fat:e.fatPart,carbon:e.carbonPart})}validatorSumIs100(e){var t,r,a,n,i,s;return 100!==(null===(r=null===(t=e)||void 0===t?void 0:t.get("protein"))||void 0===r?void 0:r.value)+(null===(n=null===(a=e)||void 0===a?void 0:a.get("fat"))||void 0===n?void 0:n.value)+(null===(s=null===(i=e)||void 0===i?void 0:i.get("carbon"))||void 0===s?void 0:s.value)?{sumvalidator:!0}:null}recalculateFormChanges(e){const t=Object(y.f)(e,this._mealTypeOriginal);t&&this.form.dirty&&this.form.markAsPristine(),!t&&this.form.pristine&&this.form.markAsDirty()}save(){this.form.valid&&(this.form.dirty?this.saved.next(this.mealType):this.errorMessages="\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0441\u0442\u044c \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f")}resetClicked(){this._mealTypeSub.next(this._mealTypeOriginal)}}return e.\u0275fac=function(t){return new(t||e)(o.Pb(i.c))},e.\u0275cmp=o.Jb({type:e,selectors:[["rg-meal-types-item-row"]],inputs:{index:"index",mealType:"mealType"},outputs:{saved:"saved"},decls:33,vars:15,consts:[["novalidate","",3,"formGroup","ngSubmit"],[1,"form-row"],[1,"form-group","col-sm-4"],["formControlName","caption","type","text",1,"form-control","form-control-sm"],["caption",""],[1,"form-group","col-sm-2"],["formControlName","kkal","type","number",1,"form-control","form-control-sm"],["formControlName","protein","type","number",1,"form-control","form-control-sm"],["formControlName","fat","type","number",1,"form-control","form-control-sm"],["formControlName","carbon","type","number",1,"form-control","form-control-sm"],[1,"form-row","justify-content-end",3,"hidden"],[1,"text-danger","mr-auto","align-self-start","ml-3","mb-3"],[4,"ngIf"],[1,"col-auto"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"btn","btn-secondary",3,"click"]],template:function(e,t){if(1&e&&(o.Vb(0,"form",0),o.hc("ngSubmit",(function(e){return t.save()})),o.Vb(1,"div",1),o.Vb(2,"div",2),o.Vb(3,"label"),o.Fc(4,"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435"),o.Ub(),o.Qb(5,"input",3,4),o.Ub(),o.Vb(7,"div",5),o.Vb(8,"label"),o.Fc(9,"\u041a\u041a\u0430\u043b"),o.Ub(),o.Qb(10,"input",6),o.Ub(),o.Vb(11,"div",5),o.Vb(12,"label"),o.Fc(13,"\u0411\u0435\u043b\u043a\u043e\u0432, %"),o.Ub(),o.Qb(14,"input",7),o.Ub(),o.Vb(15,"div",5),o.Vb(16,"label"),o.Fc(17,"\u0416\u0438\u0440\u043e\u0432, %"),o.Ub(),o.Qb(18,"input",8),o.Ub(),o.Vb(19,"div",5),o.Vb(20,"label"),o.Fc(21,"\u0423\u0433\u043b., %"),o.Ub(),o.Qb(22,"input",9),o.Ub(),o.Ub(),o.Vb(23,"div",10),o.Vb(24,"small",11),o.Dc(25,g,2,0,"div",12),o.Dc(26,j,2,0,"div",12),o.Ub(),o.Vb(27,"div",13),o.Vb(28,"button",14),o.Fc(29," Save "),o.Ub(),o.Ub(),o.Vb(30,"div",13),o.Vb(31,"button",15),o.hc("click",(function(e){return t.resetClicked()})),o.Fc(32," Reset "),o.Ub(),o.Ub(),o.Ub(),o.Ub()),2&e){var r;const e=null==(r=t.form.get("caption"))?null:null==r.errors?null:r.errors.required;o.oc("formGroup",t.form),o.Cb(3),o.Db("for","captionCtrl"+t.index),o.Cb(2),o.Db("id","captionCtrl"+t.index),o.Cb(3),o.Db("for","kkalCtrl"+t.index),o.Cb(2),o.Db("id","kkalCtrl"+t.index),o.Cb(2),o.Db("for","proteinCtrl"+t.index),o.Cb(2),o.Db("id","proteinCtrl"+t.index),o.Cb(2),o.Db("for","fatCtrl"+t.index),o.Cb(2),o.Db("id","fatCtrl"+t.index),o.Cb(2),o.Db("for","carbonCtrl"+t.index),o.Cb(2),o.Db("id","carbonCtrl"+t.index),o.Cb(1),o.oc("hidden",!t.form.dirty),o.Cb(2),o.oc("ngIf",e),o.Cb(1),o.oc("ngIf",null==t.form?null:null==t.form.errors?null:t.form.errors.sumvalidator),o.Cb(2),o.oc("disabled",!t.form.valid)}},directives:[i.u,i.l,i.e,i.a,i.k,i.d,i.p,n.l],styles:[""]}),e})();function U(e,t){if(1&e){const e=o.Wb();o.Vb(0,"div",8),o.Vb(1,"rg-meal-types-item-row",9),o.hc("saved",(function(t){return o.xc(e),o.jc().onSaved(t)})),o.Ub(),o.Vb(2,"div",10),o.Vb(3,"button",11),o.hc("click",(function(r){o.xc(e);const a=t.index;return o.jc().removeMealType(a)})),o.Qb(4,"i",12),o.Ub(),o.Ub(),o.Ub()}if(2&e){const e=t.$implicit,r=t.index;o.Cb(1),o.oc("mealType",e)("index",r)}}let x=(()=>{class e{constructor(){this.saved=new o.o,this.added=new o.o,this.deleted=new o.o}ngOnInit(){}onSaved(e){this.saved.next(e)}removeMealType(e){this.deleted.next(this.mealTypes[e].id)}addNewMealType(){this.added.next(!0)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Jb({type:e,selectors:[["rg-meal-types-list"]],inputs:{mealTypes:"mealTypes"},outputs:{saved:"saved",added:"added",deleted:"deleted"},decls:10,vars:1,consts:[[1,"card","border-primary","m-3"],[1,"card-header"],[1,"card-body","text-primary"],[1,"card-text","pr-3"],["class","d-flex align-items-end",4,"ngFor","ngForOf"],[1,"form-group"],["type","button",1,"btn","btn-primary","ml-3","btn-sm",3,"click"],[1,"fas","fa-folder-plus","mr-1"],[1,"d-flex","align-items-end"],[1,"flex-grow-1",3,"mealType","index","saved"],[1,"justify-content-center","align-items-center"],["type","button",1,"btn","btn-primary","btn-sm","mx-3","mb-3",3,"click"],[1,"fas","fa-folder-minus"]],template:function(e,t){1&e&&(o.Vb(0,"div",0),o.Vb(1,"div",1),o.Fc(2," Meal Types "),o.Ub(),o.Vb(3,"div",2),o.Vb(4,"div",3),o.Dc(5,U,5,2,"div",4),o.Vb(6,"div",5),o.Vb(7,"button",6),o.hc("click",(function(e){return t.addNewMealType()})),o.Qb(8,"i",7),o.Fc(9,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c MealType "),o.Ub(),o.Ub(),o.Ub(),o.Ub(),o.Ub()),2&e&&(o.Cb(5),o.oc("ngForOf",t.mealTypes))},directives:[n.k,k],styles:[""]}),e})();const V=[{path:"",component:l,children:[{path:"",pathMatch:"full",redirectTo:"all"},{path:"all",component:(()=>{class e{constructor(e,t){this.store=e,this.shared=t,this.mealTypes$=this.store.select(d.f)}ngOnInit(){}onSaved(e){this.shared.ifEmpty(e.id)?this.store.dispatch(a.mealTypeCreate({mealType:e})):this.store.dispatch(a.mealTypeUpdate({mealType:e}))}onDeleted(e){this.shared.ifEmpty(e)||this.store.dispatch(a.mealTypeDelete({id:e}))}onAdded(){const e=new c;this.store.dispatch(a.mealTypeCreate({mealType:e}))}}return e.\u0275fac=function(t){return new(t||e)(o.Pb(u.h),o.Pb(f.a))},e.\u0275cmp=o.Jb({type:e,selectors:[["rg-meal-types-provider"]],decls:2,vars:3,consts:[[3,"mealTypes","saved","added","deleted"]],template:function(e,t){1&e&&(o.Vb(0,"rg-meal-types-list",0),o.hc("saved",(function(e){return t.onSaved(e)}))("added",(function(e){return t.onAdded()}))("deleted",(function(e){return t.onDeleted(e)})),o.kc(1,"async"),o.Ub()),2&e&&o.oc("mealTypes",o.lc(1,1,t.mealTypes$))},directives:[x],pipes:[n.b],encapsulation:2,changeDetection:0}),e})()}]}];let w=(()=>{class e{}return e.\u0275mod=o.Nb({type:e}),e.\u0275inj=o.Mb({factory:function(t){return new(t||e)},imports:[[s.f.forChild(V)],s.f]}),e})();var S=r("snw9"),D=r("5+tZ"),M=r("JIr8"),F=r("LRne");let _=(()=>{class e{}return e.\u0275mod=o.Nb({type:e}),e.\u0275inj=o.Mb({factory:function(t){return new(t||e)}}),e})();var N=r("AytR"),P=r("tk/3");let $=(()=>{class e{constructor(e,t){this.http=e,this.shared=t}updateMealType(e){return this.http.post(N.a.mealTypesUrl+N.a.updateMealType,e)}createMealType(e){return e.id=this.shared.getGuidEmpty(),this.http.post(N.a.mealTypesUrl+N.a.updateMealType,e)}deleteMealType(e){return this.http.post(N.a.mealTypesUrl+N.a.deleteMealType,`"${e}"`,{headers:{"Content-Type":"application/json"}})}}return e.\u0275fac=function(t){return new(t||e)(o.dc(P.b),o.dc(f.a))},e.\u0275prov=o.Lb({token:e,factory:e.\u0275fac,providedIn:_}),e})(),I=(()=>{class e{constructor(e,t){this.actions$=e,this.mealTypesService=t,this.updateMealType$=Object(S.d)(()=>this.actions$.pipe(Object(S.e)(a.mealTypeUpdate),Object(D.a)(e=>this.mealTypesService.updateMealType(e.mealType).pipe(Object(C.a)(e=>d.a.mealTypeUpdateSuccess({mealType:e})))))),this.createMealType$=Object(S.d)(()=>this.actions$.pipe(Object(S.e)(a.mealTypeCreate),Object(D.a)(e=>this.mealTypesService.createMealType(e.mealType).pipe(Object(C.a)(e=>d.a.mealTypeCreateSuccess({mealType:e})))))),this.deleteMealType$=Object(S.d)(()=>this.actions$.pipe(Object(S.e)(a.mealTypeDelete),Object(D.a)(e=>this.mealTypesService.deleteMealType(e.id).pipe(Object(C.a)(e=>d.a.mealTypeDeleteSuccess({id:e})),Object(M.a)(e=>Object(F.a)(a.mealTypeDeleteFailed({status:e.error})))))))}}return e.\u0275fac=function(t){return new(t||e)(o.dc(S.a),o.dc($))},e.\u0275prov=o.Lb({token:e,factory:e.\u0275fac}),e})();const Q=Object(u.p)({deleteStatus:""},Object(u.r)(a.mealTypeDeleteFailed,(e,{status:t})=>Object.assign(Object.assign({},e),{deleteStatus:t})),Object(u.r)(d.a.mealTypeDeleteSuccess,(e,{id:t})=>Object.assign(Object.assign({},e),{deleteStatus:t})));function E(e,t){return Q(e,t)}var J=r("z6cu"),L=r("gCoc");let q=(()=>{class e{constructor(e){this.fakeback=e}intercept(e,t){if(e.url.includes(N.a.mealTypesUrl)&&e.url.endsWith(N.a.updateMealType)&&"POST"===e.method)return this.ok(this.fakeback.updateMealType(e.body));if(e.url.includes(N.a.mealTypesUrl)&&e.url.endsWith(N.a.deleteMealType)&&"POST"===e.method){const t=this.fakeback.deleteMealType(e.body);return t===e.body?this.ok(t):this.badRequest(t)}return t.handle(e)}ok(e){return Object(F.a)(new P.d({status:200,body:e}))}badRequest(e){return Object(F.a)(new P.d({status:400,body:e}))}error(e){return Object(J.a)({error:{message:e}})}}return e.\u0275fac=function(t){return new(t||e)(o.dc(L.a))},e.\u0275prov=o.Lb({token:e,factory:e.\u0275fac}),e})();r.d(t,"MealTypesModule",(function(){return A}));let A=(()=>{class e{}return e.\u0275mod=o.Nb({type:e}),e.\u0275inj=o.Mb({factory:function(t){return new(t||e)},providers:[N.a.useFakeback?{provide:P.a,useClass:q,multi:!0}:[]],imports:[[n.c,P.c,w,i.r,u.j.forFeature("mealTypes",E),S.c.forFeature([I]),_]]}),e})()},l5mm:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var a=r("HDdC"),n=r("D0XW"),i=r("Y7HM");function s(e=0,t=n.a){return(!Object(i.a)(e)||e<0)&&(e=0),t&&"function"==typeof t.schedule||(t=n.a),new a.a(r=>(r.add(t.schedule(o,e,{subscriber:r,counter:0,period:e})),r))}function o(e){const{subscriber:t,counter:r,period:a}=e;t.next(r),this.schedule({subscriber:t,counter:r+1,period:a},a)}}}]);